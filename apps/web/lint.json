
> web@0.1.0 lint
> eslint --format json

[{"filePath":"/home/asaki/Documents/codes/first-commit/apps/web/eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/asaki/Documents/codes/first-commit/apps/web/next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/asaki/Documents/codes/first-commit/apps/web/postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/asaki/Documents/codes/first-commit/apps/web/src/app/lab/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[450,453],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[450,453],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[713,716],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[713,716],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[771,774],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[771,774],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1173,1176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1173,1176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1803,1806],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1803,1806],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2908,2911],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2908,2911],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loadScript' is assigned a value but never used.","line":85,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":152,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6822,6825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6822,6825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":153,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6865,6868],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6865,6868],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":154,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6911,6914],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6911,6914],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":279,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":279,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12478,12481],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12478,12481],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'assetGroup' is defined but never used.","line":313,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":313,"endColumn":59},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":345,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":345,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15386,15389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15386,15389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":361,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":361,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16306,16309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16306,16309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":375,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":375,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16953,16956],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16953,16956],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":388,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":388,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17717,17720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17717,17720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":403,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":403,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18608,18611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18608,18611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":418,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":418,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19527,19530],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19527,19530],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":436,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":436,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20583,20586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20583,20586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":447,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":447,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21220,21223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21220,21223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":469,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":469,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22387,22390],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22387,22390],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":491,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":491,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23301,23304],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23301,23304],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":560,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":560,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26293,26296],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26293,26296],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":771,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":771,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[35651,35654],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[35651,35654],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'seed'. Either include it or remove the dependency array.","line":762,"column":8,"nodeType":"ArrayExpression","endLine":762,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [seed]","fix":{"range":[35398,35400],"text":"[seed]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":22,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useEffect, useRef, useState, useCallback, Suspense } from 'react';\nimport { useSearchParams } from 'next/navigation';\n\nfunction LabContent() {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const searchParams = useSearchParams();\n    const repoId = searchParams.get('repoId');\n    const jobId = searchParams.get('jobId');\n\n    // --- REAL API DATA ---\n    const [apiComponents, setApiComponents] = useState<any[]>([]);\n    const [jobStatus, setJobStatus] = useState<string>('pending');\n    const [jobProgress, setJobProgress] = useState<number>(0);\n    const [repoName, setRepoName] = useState<string>('');\n    const [selectedComponent, setSelectedComponent] = useState<any>(null);\n    const onBuildingClickRef = useRef<((data: any) => void) | null>(null);\n    const [seed, setSeed] = useState('HOLOGRAPHIC');\n    const heightRange = 100;\n    const updateTerrainRef = useRef<((s: string, h: number) => void) | null>(null);\n    const triggerFocusRef = useRef<((name: string | null) => void) | null>(null);\n\n    // Keep refs so Three.js closure can read latest state without re-running useEffect\n    const apiComponentsRef = useRef<any[]>([]);\n    const jobStatusRef = useRef<string>('pending');\n\n    // Polling and Fetching\n    useEffect(() => {\n        if (!repoId) return;\n        const API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001';\n\n        let pollTimer: NodeJS.Timeout;\n\n        const fetchData = async () => {\n            try {\n                const res = await fetch(`${API_BASE}/api/repos/${repoId}`);\n                if (!res.ok) throw new Error('Failed to fetch repo');\n                const data = await res.json();\n\n                setRepoName(data.repo.name);\n\n                const latestJob = data.analysisJobs?.find((j: any) => String(j.id) === String(jobId)) || data.analysisJobs?.[0];\n                if (latestJob) {\n                    setJobStatus(latestJob.status);\n                    setJobProgress(latestJob.progress || 0);\n                    jobStatusRef.current = latestJob.status;\n                }\n\n                if (data.components) {\n                    setApiComponents(data.components);\n                    apiComponentsRef.current = data.components;\n                }\n\n                // Continue polling if not finished\n                if (jobStatusRef.current === 'pending' || jobStatusRef.current === 'running') {\n                    pollTimer = setTimeout(fetchData, 3000);\n                }\n            } catch (err) {\n                console.warn('[Lab] Data fetch failed:', err);\n                pollTimer = setTimeout(fetchData, 5000);\n            }\n        };\n\n        fetchData();\n        return () => clearTimeout(pollTimer);\n    }, [repoId, jobId]);\n\n    // Bridge: set the callback so Three.js onClick can update React state\n    useEffect(() => {\n        onBuildingClickRef.current = (data: any) => {\n            setSelectedComponent(data);\n        };\n    }, []);\n\n    const closeModal = useCallback(() => setSelectedComponent(null), []);\n\n    useEffect(() => {\n        if (typeof window === 'undefined' || !containerRef.current) return;\n\n        let cleanup = () => { };\n\n        const loadGraphics = async () => {\n            // Helper to load scripts since dynamic import(url) is failing in Turbopack\n            const loadScript = (src: string, isModule = false) => {\n                return new Promise((resolve, reject) => {\n                    const script = document.createElement('script');\n                    script.src = src;\n                    if (isModule) script.type = 'module';\n                    script.onload = resolve;\n                    script.onerror = reject;\n                    document.head.appendChild(script);\n                });\n            };\n\n            // Inject importmap so browser can resolve bare 'three' specifiers in CDN-loaded examples\n            const im = document.createElement('script');\n            im.type = 'importmap';\n            im.textContent = JSON.stringify({\n                imports: {\n                    \"three\": \"https://unpkg.com/three@0.161.0/build/three.module.js\"\n                }\n            });\n            document.head.appendChild(im);\n\n            // Since we need Three.js and modules, we'll use a hack to get THREE globally\n            // or just import them as modules but through a script tag that doesn't get processed by Turbopack\n            // Actually, let's use the native browser dynamic import via eval to bypass Turbopack\n            const THREE = await eval(`import('https://unpkg.com/three@0.161.0/build/three.module.js')`);\n            const { OrbitControls } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/controls/OrbitControls.js')`);\n            const { EffectComposer } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/postprocessing/EffectComposer.js')`);\n            const { RenderPass } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/postprocessing/RenderPass.js')`);\n            const { UnrealBloomPass } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/postprocessing/UnrealBloomPass.js')`);\n            const { ShaderPass } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/postprocessing/ShaderPass.js')`);\n            const { GammaCorrectionShader } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/shaders/GammaCorrectionShader.js')`);\n            const { RoundedBoxGeometry } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/geometries/RoundedBoxGeometry.js')`);\n\n            const THEME = {\n                bg: 0x070a0f,\n                terrain: 0x0a0c0e,\n                grid: 0x374151,\n                line1: 0x2ef2c8,\n                line2: 0x86a8ff,\n                asset: 0xd9dde3,\n                cable: 0x2ef2c8,\n                accent: 0x2ef2c8,\n                outlines: 0xffffff,\n                tints: {\n                    language: 0xe5e7eb,\n                    database: 0x86a8ff,\n                    framework: 0x2ef2c8,\n                    library: 0xd1d5db,\n                    ui_component: 0xf472b6,\n                    state_management: 0x60a5fa,\n                    validation: 0x34d399,\n                    animation: 0xfcd34d,\n                    tooling: 0xfacc15,\n                    infra: 0xa855f7,\n                    testing: 0x10b981,\n                    ci_cd: 0x3b82f6,\n                    cache: 0xf97316,\n                    other: 0xd9dde3,\n                    default: 0xd9dde3\n                }\n            };\n\n            // --- ENGINE VARS ---\n            let scene, camera, renderer, composer, controls, raycaster, mouse;\n            let hoveredGroup = null;\n            let cablesGroup, buildingsGroup;\n\n            const pickables: any[] = [];\n            const animatables: any[] = [];\n            const districtGroups: any = {};\n\n            const init = () => {\n                scene = new THREE.Scene();\n                scene.background = new THREE.Color(THEME.bg);\n\n                camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 1, 5000);\n                camera.position.set(600, 400, 600);\n                camera.lookAt(0, 0, 0);\n\n                renderer = new THREE.WebGLRenderer({ antialias: true, powerPreference: \"high-performance\", alpha: false });\n                renderer.setClearColor(THEME.bg, 1);\n                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n                renderer.setSize(window.innerWidth, window.innerHeight);\n                renderer.shadowMap.enabled = false;\n                renderer.toneMapping = THREE.ACESFilmicToneMapping;\n                renderer.toneMappingExposure = 1.0;\n                renderer.outputColorSpace = THREE.SRGBColorSpace;\n                containerRef.current.appendChild(renderer.domElement);\n\n                composer = new EffectComposer(renderer);\n                composer.addPass(new RenderPass(scene, camera));\n\n                const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 0.35, 0.45, 0.35);\n                composer.addPass(bloomPass);\n                composer.addPass(new ShaderPass(GammaCorrectionShader));\n\n                controls = new OrbitControls(camera, renderer.domElement);\n                controls.enableRotate = true;\n                controls.enableDamping = true;\n                controls.minPolarAngle = Math.PI / 4;\n                controls.maxPolarAngle = Math.PI / 2.5;\n                controls.rotateSpeed = 0.5;\n\n                scene.add(new THREE.AmbientLight(0xffffff, 0.15));\n                scene.add(new THREE.HemisphereLight(0xffffff, 0x000000, 0.25));\n\n                const keyLight = new THREE.DirectionalLight(0xffffff, 1.2);\n                keyLight.position.set(400, 800, 300);\n                scene.add(keyLight);\n\n                cablesGroup = new THREE.Group();\n                scene.add(cablesGroup);\n\n                buildingsGroup = new THREE.Group();\n                scene.add(buildingsGroup);\n\n                updateSeededTerrain(seed, heightRange);\n\n                raycaster = new THREE.Raycaster();\n                mouse = new THREE.Vector2();\n\n                syncInfrastructure();\n                fitCameraToSceneBounds();\n\n                let isMouseDown = false;\n                let mouseDownPos = { x: 0, y: 0 };\n\n                window.addEventListener('resize', onWindowResize);\n                window.addEventListener('pointermove', onPointerMove);\n                window.addEventListener('mousedown', (e) => {\n                    isMouseDown = true;\n                    mouseDownPos = { x: e.clientX, y: e.clientY };\n                });\n                window.addEventListener('mouseup', (e) => {\n                    if (isMouseDown) {\n                        const dx = Math.abs(e.clientX - mouseDownPos.x);\n                        const dy = Math.abs(e.clientY - mouseDownPos.y);\n                        if (dx < 4 && dy < 4) {\n                            onClick();\n                        }\n                    }\n                    isMouseDown = false;\n                });\n            };\n\n            const pseudoNoise = (x, z) => {\n                let y = Math.sin(x * 0.012) * Math.cos(z * 0.015) * 45;\n                y += Math.sin(x * 0.025 + z * 0.01) * 20;\n                y += Math.cos(x * 0.06) * Math.sin(z * 0.05) * 8;\n                return y;\n            };\n\n            const mulberry32 = (a: number) => {\n                return () => {\n                    let t = a += 0x6D2B79F5;\n                    t = Math.imul(t ^ t >>> 15, t | 1);\n                    t ^= t + Math.imul(t ^ t >>> 7, t | 61);\n                    return ((t ^ t >>> 14) >>> 0) / 4294967296;\n                };\n            };\n\n            const createSeededNoise = (seedStr: string) => {\n                let seedNum = 2166136261;\n                for (let i = 0; i < seedStr.length; i++) {\n                    seedNum ^= seedStr.charCodeAt(i);\n                    seedNum = Math.imul(seedNum, 16777619);\n                }\n                const rand = mulberry32(seedNum);\n\n                const gridSize = 16;\n                const grid: number[][] = [];\n                for (let i = 0; i <= gridSize; i++) {\n                    grid[i] = [];\n                    for (let j = 0; j <= gridSize; j++) grid[i][j] = rand();\n                }\n\n                const fade = (t: number) => t * t * t * (t * (t * 6 - 15) + 10);\n                const lerp = (a: number, b: number, t: number) => a + (b - a) * t;\n\n                return (x: number, y: number) => {\n                    const nx = ((x + 1000) / 2000) * gridSize;\n                    const ny = ((y + 1000) / 2000) * gridSize;\n                    const i = Math.floor(nx), j = Math.floor(ny);\n                    const fi = nx - i, fj = ny - j;\n                    const i0 = Math.max(0, Math.min(gridSize, i));\n                    const j0 = Math.max(0, Math.min(gridSize, j));\n                    const i1 = Math.min(gridSize, i0 + 1);\n                    const j1 = Math.min(gridSize, j0 + 1);\n                    const u = fade(fi), v = fade(fj);\n                    return lerp(lerp(grid[i0][j0], grid[i1][j0], u), lerp(grid[i0][j1], grid[i1][j1], u), v);\n                };\n            };\n\n            let currentNoiseFuncBySeed: ((x: number, y: number) => number) | null = null;\n            let seededTerrainMesh: any = null;\n\n            const updateSeededTerrain = (newSeed: string, hRange: number) => {\n                if (!scene) return;\n                if (seededTerrainMesh) {\n                    scene.remove(seededTerrainMesh);\n                    if (seededTerrainMesh.geometry) seededTerrainMesh.geometry.dispose();\n                }\n\n                currentNoiseFuncBySeed = createSeededNoise(newSeed);\n                const size = 2000, segments = 80;\n                const geo = new THREE.PlaneGeometry(size, size, segments, segments);\n                const pos = geo.attributes.position;\n                for (let i = 0; i < pos.count; i++) {\n                    const x = pos.getX(i);\n                    const y = pos.getY(i);\n                    pos.setZ(i, currentNoiseFuncBySeed(x, y) * hRange);\n                }\n                geo.computeVertexNormals();\n                pos.needsUpdate = true;\n\n                const mat = new THREE.MeshBasicMaterial({\n                    color: 0xaaaaaa,\n                    wireframe: true,\n                    transparent: true,\n                    opacity: 0.1\n                });\n                seededTerrainMesh = new THREE.Mesh(geo, mat);\n                seededTerrainMesh.rotation.x = -Math.PI / 2;\n                seededTerrainMesh.position.y = -110;\n                seededTerrainMesh.position.z = 400;\n                scene.add(seededTerrainMesh);\n\n                // Re-anchor assets in sync with terrain\n                buildingsGroup.children.forEach(assetGroup => {\n                    // districtGroups are Groups containing assets, or assets directly in buildingsGroup\n                    // Actually syncInfrastructure puts districtGroups into buildingsGroup, \n                    // and assets into distGroups or directly into buildingsGroup.\n                    // We need to find all pickable groups.\n                    // Since buildingsGroup contains districts, we traverse them.\n                });\n\n                // Simpler: just re-run getTerrainY update for all placed assets\n                pickables.forEach(asset => {\n                    const ax = asset.position.x;\n                    const az = asset.position.z;\n                    asset.position.y = getTerrainY(ax, az);\n                });\n\n                createInfrastructureCables();\n            };\n\n            updateTerrainRef.current = updateSeededTerrain;\n\n            const getTerrainY = (x, z) => {\n                if (currentNoiseFuncBySeed) {\n                    // Mapping Fix: \n                    // World X -> Local X\n                    // World Z -> Local Y (due to -PI/2 rotation and z=400 shift)\n                    // Local Y = 400 - World Z\n                    return (currentNoiseFuncBySeed(x, 400 - z) * heightRange) - 110;\n                }\n                return pseudoNoise(x, z) - 50;\n            };\n\n\n            const createAssetMaterial = (param: any = 'default') => {\n                const color = typeof param === 'string'\n                    ? (THEME.tints[param] || THEME.tints.default)\n                    : (param.color || THEME.tints.default);\n                return new THREE.MeshStandardMaterial({ color: color, roughness: 0.9, metalness: 0.0, transparent: true, opacity: 1.0 });\n            };\n\n            const addTechnicalOutlines = (mesh, group) => {\n                const edges = new THREE.EdgesGeometry(mesh.geometry, 25);\n                const line = new THREE.LineSegments(edges, new THREE.LineBasicMaterial({ color: THEME.outlines, transparent: true, opacity: 0.08 }));\n                line.position.copy(mesh.position);\n                line.rotation.copy(mesh.rotation);\n                line.scale.copy(mesh.scale);\n                group.add(line);\n            };\n\n            const finalizeAsset = (group, name, category, info, distId, apiData?: any) => {\n                group.traverse(child => {\n                    if (child.isMesh) {\n                        child.castShadow = true;\n                        child.receiveShadow = true;\n                        if (child.userData.outlined !== false) addTechnicalOutlines(child, group);\n                    }\n                });\n                // Attach real API data if available, fallback to mock info\n                group.userData = { name, category, info, distId, ...(apiData || {}) };\n                pickables.push(group);\n                return group;\n            };\n\n            const createLanguageTower = (name, distId, apiData?: any) => {\n                const group = new THREE.Group();\n                const pct = apiData?.pct || 70;\n                const h = pct * 2.2, w = 18;\n                const bodyGeo = new RoundedBoxGeometry(w, h, w, 2, 2);\n                const body = new THREE.Mesh(bodyGeo.translate(0, h / 2, 0), createAssetMaterial('language'));\n                group.add(body);\n                const capGeo = new RoundedBoxGeometry(w + 4, 4, w + 4, 2, 2);\n                const cap = new THREE.Mesh(capGeo.translate(0, h + 2, 0), createAssetMaterial('language'));\n                group.add(cap);\n                return finalizeAsset(group, name, \"Language\", `${pct}% Complexity`, distId, apiData);\n            };\n\n            const createPowerPlant = (name, distId, apiData?: any) => {\n                const group = new THREE.Group();\n                const base = new THREE.Mesh(new RoundedBoxGeometry(36, 18, 36, 2, 2).translate(0, 9, 0), createAssetMaterial());\n                group.add(base);\n                for (let i = -1; i <= 1; i += 2) {\n                    const stack = new THREE.Mesh(new THREE.CylinderGeometry(7, 10, 32, 24).translate(i * 10, 25, 0), createAssetMaterial());\n                    group.add(stack);\n                    const ring = new THREE.Mesh(new THREE.TorusGeometry(8.5, 1, 8, 32), createAssetMaterial());\n                    ring.rotation.x = Math.PI / 2;\n                    ring.position.set(i * 10, 24, 0);\n                    group.add(ring);\n                }\n                return finalizeAsset(group, name, \"Engine\", \"Processor Core\", distId, apiData);\n            };\n\n            const createSilo = (name, distId, apiData?: any) => {\n                const group = new THREE.Group();\n                const body = new THREE.Mesh(new THREE.CylinderGeometry(20, 20, 55, 32).translate(0, 27.5, 0), createAssetMaterial('database'));\n                group.add(body);\n                [15, 40].forEach(y => {\n                    const ring = new THREE.Mesh(new THREE.TorusGeometry(20.5, 1.2, 8, 32), createAssetMaterial('database'));\n                    ring.rotation.x = Math.PI / 2;\n                    ring.position.y = y;\n                    group.add(ring);\n                });\n                const cap = new THREE.Mesh(new THREE.SphereGeometry(20, 32, 16, 0, Math.PI * 2, 0, Math.PI / 2).translate(0, 55, 0), createAssetMaterial('database'));\n                group.add(cap);\n                return finalizeAsset(group, name, \"Storage\", \"Data Bulk\", distId, apiData);\n            };\n\n            const createSolarField = (name, distId, apiData?: any) => {\n                const group = new THREE.Group();\n                for (let i = 0; i < 9; i++) {\n                    const panelGroup = new THREE.Group();\n                    const pw = 16, ph = 20;\n                    const panel = new THREE.Mesh(new THREE.PlaneGeometry(pw, ph), createAssetMaterial());\n                    panel.rotation.x = -Math.PI / 2;\n                    panelGroup.add(panel);\n                    const frame = new THREE.Mesh(new THREE.BoxGeometry(pw + 1.5, 1, ph + 1.5).translate(0, -0.5, 0), createAssetMaterial({ color: 0xcccccc }));\n                    frame.userData.outlined = false;\n                    panelGroup.add(frame);\n                    panelGroup.rotation.x = -Math.PI / 8;\n                    panelGroup.position.set((i % 3) * 22 - 22, 6, Math.floor(i / 3) * 26 - 26);\n                    group.add(panelGroup);\n                }\n                return finalizeAsset(group, name, \"Frontend\", \"UI Cell\", distId, apiData);\n            };\n\n            const createTransmissionTower = (name, distId, apiData?: any) => {\n                const group = new THREE.Group();\n                const pole = new THREE.Mesh(new THREE.CylinderGeometry(2, 9, 85, 4).translate(0, 42.5, 0), createAssetMaterial('infra'));\n                group.add(pole);\n                for (let h = 35; h <= 75; h += 20) {\n                    const arm = new THREE.Mesh(new THREE.BoxGeometry(48, 4, 3).translate(0, h, 0), createAssetMaterial('infra'));\n                    group.add(arm);\n                }\n                return finalizeAsset(group, name, \"DevOps\", \"Feed Pipeline\", distId, apiData);\n            };\n\n            const createTurbine = (name, distId, apiData?: any) => {\n                const group = new THREE.Group();\n                const tower = new THREE.Mesh(new THREE.CylinderGeometry(3, 7, 100, 24).translate(0, 50, 0), createAssetMaterial());\n                group.add(tower);\n                const nacelle = new THREE.Mesh(new RoundedBoxGeometry(10, 10, 16, 2, 2).translate(0, 100, 4), createAssetMaterial());\n                group.add(nacelle);\n                const blades = new THREE.Group();\n                blades.position.set(0, 100, 12);\n                group.add(blades);\n                for (let i = 0; i < 3; i++) {\n                    const blade = new THREE.Mesh(new THREE.BoxGeometry(4, 45, 1).translate(0, 22.5, 0), createAssetMaterial());\n                    blade.rotation.z = (i * Math.PI * 2) / 3;\n                    blades.add(blade);\n                }\n                animatables.push(() => { blades.rotation.z += 0.04; });\n                return finalizeAsset(group, name, \"Tooling\", \"Gateway\", distId, apiData);\n            };\n\n            const syncInfrastructure = () => {\n                const comps = apiComponentsRef.current;\n\n                // Group by type\n                const groups: any = {};\n                comps.forEach(c => {\n                    const t = c.type || 'other';\n                    if (!groups[t]) groups[t] = [];\n                    groups[t].push(c);\n                });\n\n                const types = Object.keys(groups);\n                if (types.length === 0) {\n                    // Periodic check for new components if still scanning\n                    if (jobStatusRef.current === 'pending' || jobStatusRef.current === 'running') {\n                        setTimeout(syncInfrastructure, 4000);\n                    }\n                    return;\n                }\n\n                buildingsGroup.clear();\n                pickables.length = 0;\n                districtGroups.length = 0; // Reset district mapping\n                Object.keys(districtGroups).forEach(k => delete districtGroups[k]);\n\n                const gridSpacing = 280;\n                const typeToFact: any = {\n                    language: createLanguageTower,\n                    framework: createPowerPlant,\n                    database: createSilo,\n                    library: createPowerPlant,\n                    ui_component: createSolarField,\n                    state_management: createPowerPlant,\n                    validation: createSilo,\n                    animation: createTurbine,\n                    cache: createSilo,\n                    ci_cd: createTransmissionTower,\n                    infra: createTransmissionTower,\n                    tooling: createTurbine,\n                    testing: createTurbine,\n                    other: createTurbine\n                };\n\n                types.forEach((type, idx) => {\n                    const ox = (idx % 3) * gridSpacing - gridSpacing;\n                    const oz = Math.floor(idx / 3) * gridSpacing - gridSpacing / 2;\n\n                    const distGroup = new THREE.Group();\n                    distGroup.position.set(ox, 0, oz);\n                    districtGroups[type] = distGroup;\n                    buildingsGroup.add(distGroup);\n\n                    groups[type].forEach((item, i) => {\n                        const factory = typeToFact[type] || createTurbine;\n                        const asset = factory(item.name, type, {\n                            description: item.doc_description || item.description,\n                            version: item.version,\n                            confidence: item.confidence,\n                            docUrl: item.doc_url,\n                            pct: 70\n                        });\n\n                        const ax = (i % 2) * 90 - 45 + ox;\n                        const az = Math.floor(i / 2) * 90 - 45 + oz;\n                        const ay = getTerrainY(ax, az);\n                        asset.position.set(ax, ay, az);\n                        buildingsGroup.add(asset);\n                    });\n                });\n\n                createInfrastructureCables();\n\n                // Periodic check for new components if still scanning\n                if (jobStatusRef.current === 'pending' || jobStatusRef.current === 'running') {\n                    setTimeout(syncInfrastructure, 5000);\n                }\n            };\n\n            const createInfrastructureCables = () => {\n                const types = Object.keys(districtGroups);\n                if (types.length < 2) return;\n\n                cablesGroup.clear();\n\n                // Simple chain connection for now\n                for (let i = 0; i < types.length - 1; i++) {\n                    const from = types[i];\n                    const to = types[i + 1];\n\n                    const startGroup = districtGroups[from];\n                    const endGroup = districtGroups[to];\n                    if (!startGroup || !endGroup) continue;\n\n                    const startPos = startGroup.position.clone();\n                    const endPos = endGroup.position.clone();\n                    const points: any[] = [];\n                    const segments = 24;\n                    for (let j = 0; j <= segments; j++) {\n                        const t = j / segments;\n                        const x = startPos.x + (endPos.x - startPos.x) * t;\n                        const z = startPos.z + (endPos.z - startPos.z) * t;\n                        const y = getTerrainY(x, z) + 1.2;\n                        points.push(new THREE.Vector3(x, y, z));\n                    }\n\n                    const bundleGroup = new THREE.Group();\n                    bundleGroup.userData = { from, to };\n\n                    const geo = new THREE.BufferGeometry().setFromPoints(points);\n                    const mat = new THREE.LineBasicMaterial({ color: THEME.cable, transparent: true, opacity: 0.1 });\n                    const line = new THREE.Line(geo, mat);\n                    bundleGroup.add(line);\n\n                    const packet = new THREE.Mesh(new THREE.SphereGeometry(1.2, 8, 8), new THREE.MeshBasicMaterial({ color: THEME.accent, transparent: true, opacity: 0 }));\n                    bundleGroup.add(packet);\n\n                    const speed = 0.8 + Math.random() * 0.4;\n                    animatables.push(() => {\n                        const t = (Date.now() * 0.001 * speed) % 3;\n                        const progress = t / 3;\n                        const idx = Math.floor(progress * segments);\n                        if (idx < points.length) {\n                            packet.position.copy(points[idx]);\n                            packet.position.y += 2;\n                            packet.material.opacity = progress < 0.1 ? progress * 10 : (progress > 0.9 ? (1 - progress) * 10 : 0.6);\n                            packet.scale.setScalar(0.8 + Math.sin(Date.now() * 0.01) * 0.2);\n                        }\n                    });\n\n                    cablesGroup.add(bundleGroup);\n                }\n            };\n\n            const fitCameraToSceneBounds = () => {\n                camera.position.set(650, 650, 650);\n                camera.lookAt(0, 0, 0);\n                if (controls) controls.target.set(0, 0, 0);\n            };\n\n            triggerFocusRef.current = (name) => {\n                if (!name) {\n                    focus(null);\n                    if (hoveredGroup) { highlight(hoveredGroup, false); hoveredGroup = null; }\n                    if (onBuildingClickRef.current) onBuildingClickRef.current(null);\n                    return;\n                }\n                const target = pickables.find(p => p.userData.name === name);\n                if (target) {\n                    if (hoveredGroup && hoveredGroup !== target) {\n                        highlight(hoveredGroup, false);\n                    }\n                    hoveredGroup = target;\n                    highlight(target, true);\n                    focus(target);\n                    if (onBuildingClickRef.current) {\n                        onBuildingClickRef.current(target.userData);\n                    }\n                }\n            };\n\n            const onPointerMove = (event) => {\n                mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n                mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n                const tt = document.getElementById('tooltip');\n                if (tt) {\n                    tt.style.left = (event.clientX + 20) + 'px';\n                    tt.style.top = (event.clientY + 20) + 'px';\n                }\n                raycaster.setFromCamera(mouse, camera);\n                const hits = raycaster.intersectObjects(pickables, true);\n                if (hits.length > 0) {\n                    let g = hits[0].object; while (g.parent && !g.userData.name) g = g.parent;\n                    if (hoveredGroup !== g) {\n                        if (hoveredGroup) highlight(hoveredGroup, false);\n                        hoveredGroup = g; highlight(hoveredGroup, true);\n                    }\n                    if (tt) {\n                        tt.style.display = 'block';\n                        tt.innerHTML = `${g.userData.name} â€¢ ${g.userData.category}`;\n                    }\n                    document.body.style.cursor = 'pointer';\n                } else {\n                    if (hoveredGroup) { highlight(hoveredGroup, false); hoveredGroup = null; }\n                    if (tt) tt.style.display = 'none';\n                    document.body.style.cursor = 'default';\n                }\n            };\n\n            const highlight = (g, active) => {\n                const distId = g.userData.distId;\n                g.traverse(c => {\n                    if (c.isMesh && c.material.emissive) {\n                        c.material.emissive.setHex(active ? 0x00d2ff : 0x000000);\n                        c.material.emissiveIntensity = active ? 0.35 : 0;\n                    }\n                });\n                g.scale.setScalar(active ? 1.04 : 1.0);\n                cablesGroup.children.forEach(bundle => {\n                    const con = bundle.userData.from === distId || bundle.userData.to === distId;\n                    bundle.children.forEach(line => {\n                        if (line instanceof THREE.Line) {\n                            line.material.color.setHex(active && con ? THEME.accent : THEME.cable);\n                            line.material.opacity = active ? (con ? 0.8 : 0.05) : 0.3;\n                        }\n                    });\n                });\n            };\n\n            const onClick = () => {\n                raycaster.setFromCamera(mouse, camera);\n                const hits = raycaster.intersectObjects(pickables, true);\n                if (hits.length > 0) {\n                    let g = hits[0].object; while (g.parent && !g.userData.name) g = g.parent;\n                    focus(g);\n                    // Signal to React with the component data\n                    if (onBuildingClickRef.current) {\n                        onBuildingClickRef.current(g.userData);\n                    }\n                } else {\n                    focus(null);\n                    if (onBuildingClickRef.current) {\n                        onBuildingClickRef.current(null);\n                    }\n                }\n            };\n\n            const focus = (g) => {\n                pickables.forEach(pg => {\n                    const isF = !g || pg === g;\n                    pg.traverse(c => { if (c.isMesh) c.material.opacity = isF ? 1.0 : 0.2; });\n                });\n            };\n\n            const onWindowResize = () => {\n                camera.aspect = window.innerWidth / window.innerHeight;\n                camera.updateProjectionMatrix();\n                renderer.setSize(window.innerWidth, window.innerHeight);\n                composer.setSize(window.innerWidth, window.innerHeight);\n            };\n\n            const animate = () => {\n                const frameId = requestAnimationFrame(animate);\n                controls.update();\n                const time = Date.now() * 0.001;\n                camera.position.x += Math.sin(time * 0.2) * 0.1;\n                camera.position.z += Math.cos(time * 0.15) * 0.1;\n                animatables.forEach(f => f());\n                composer.render();\n                cleanup = () => {\n                    cancelAnimationFrame(frameId);\n                    window.removeEventListener('resize', onWindowResize);\n                    window.removeEventListener('pointermove', onPointerMove);\n                    window.removeEventListener('click', onClick);\n                    if (containerRef.current) containerRef.current.innerHTML = '';\n                    renderer.dispose();\n                    scene.clear();\n                };\n            };\n\n            init();\n            animate();\n\n            // UI Initialization\n            const intervalClock = setInterval(() => {\n                const clockEl = document.getElementById('clock');\n                if (clockEl) clockEl.innerText = new Date().toLocaleTimeString([], { hour12: false });\n            }, 1000);\n\n            const loadContainer = document.getElementById('load-bars');\n            if (loadContainer) {\n                for (let i = 0; i < 20; i++) {\n                    const bar = document.createElement('div');\n                    bar.className = 'bar';\n                    loadContainer.appendChild(bar);\n                }\n            }\n            const intervalBars = setInterval(() => {\n                if (loadContainer) {\n                    const bars = loadContainer.children;\n                    const activeCount = Math.floor(Math.random() * 15) + 5;\n                    for (let i = 0; i < bars.length; i++) {\n                        bars[i].classList.toggle('active', i < activeCount);\n                    }\n                }\n            }, 500);\n\n            const prevCleanup = cleanup;\n            cleanup = () => {\n                prevCleanup();\n                clearInterval(intervalClock);\n                clearInterval(intervalBars);\n            };\n        };\n\n        loadGraphics();\n        return () => cleanup();\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    useEffect(() => {\n        if (updateTerrainRef.current) {\n            updateTerrainRef.current(seed, heightRange);\n        }\n    }, [seed, heightRange]);\n\n    const componentsByType = React.useMemo(() => {\n        const groups: Record<string, any[]> = {};\n        apiComponents.forEach(c => {\n            const t = c.type || 'other';\n            if (!groups[t]) groups[t] = [];\n            groups[t].push(c);\n        });\n        const sortedKeys = Object.keys(groups).sort();\n        return sortedKeys.map(key => ({\n            type: key,\n            items: groups[key].sort((a, b) => a.name.localeCompare(b.name))\n        }));\n    }, [apiComponents]);\n\n    return (\n        <div className=\"relative h-screen w-full overflow-hidden bg-[#070a0f] font-sans text-[#e5e7eb]\">\n            <style jsx>{`\n        :root {\n          --accent: #2ef2c8;\n          --secondary: #86a8ff;\n          --bg-ui: rgba(10, 12, 14, 0.55);\n          --border-ui: rgba(255, 255, 255, 0.08);\n          --text-main: #e5e7eb;\n          --text-muted: #9ca3af;\n        }\n\n        /* --- TACTICAL UI OVERLAY --- */\n        #ui-overlay {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          pointer-events: none;\n          z-index: 1000;\n          display: flex;\n          flex-direction: column;\n          justify-content: space-between;\n          padding: 32px;\n          box-sizing: border-box;\n        }\n\n        .hud-card {\n          background: rgba(10, 12, 14, 0.55);\n          backdrop-filter: blur(10px);\n          border: 1px solid rgba(255, 255, 255, 0.08);\n          border-radius: 16px;\n          padding: 20px;\n          pointer-events: auto;\n        }\n\n        /* Top Left: Scope */\n        .scope-block {\n          align-self: flex-start;\n          min-width: 220px;\n        }\n        .scope-item {\n          display: flex;\n          justify-content: space-between;\n          font-size: 10px;\n          font-weight: 700;\n          letter-spacing: 0.1em;\n          margin-bottom: 8px;\n          color: #9ca3af;\n          border-bottom: 1px solid rgba(255,255,255,0.05);\n          padding-bottom: 4px;\n        }\n        .scope-item span:last-child { color: #2ef2c8; }\n\n        /* Right Stats */\n        .stats-card {\n          position: absolute;\n          top: 32px;\n          right: 32px;\n          width: 240px;\n        }\n        .stats-header { font-size: 10px; color: #9ca3af; margin-bottom: 12px; }\n        .stats-main { display: flex; align-items: center; justify-content: space-between; }\n        .stats-number { font-size: 32px; font-weight: 800; }\n        .stats-sub { font-size: 11px; color: #2ef2c8; }\n        .stats-ring { width: 40px; height: 40px; }\n\n        /* Building List */\n        .building-list-card {\n           position: absolute;\n           top: 154px;\n           right: 32px;\n           width: 240px;\n           bottom: 112px;\n           display: flex;\n           flex-direction: column;\n           padding-right: 8px; /* Room for scrollbar */\n        }\n        .building-list-header {\n           font-size: 10px; color: #9ca3af; margin-bottom: 8px; font-weight: 700; letter-spacing: 0.1em;\n        }\n        .building-list-content {\n           flex: 1;\n           overflow-y: auto;\n           padding-right: 4px;\n           scrollbar-width: none; /* Firefox */\n           -ms-overflow-style: none; /* IE/Edge */\n        }\n        .building-list-content::-webkit-scrollbar { display: none; }\n\n        .building-group-title {\n           font-size: 9px;\n           color: #86a8ff;\n           margin-top: 14px;\n           margin-bottom: 6px;\n           font-weight: 700;\n           letter-spacing: 0.1em;\n           text-transform: uppercase;\n           border-bottom: 1px solid rgba(134, 168, 255, 0.2);\n           padding-bottom: 4px;\n        }\n        .building-group-title:first-child { margin-top: 0; }\n        \n        .building-item {\n           font-size: 11px;\n           color: #e5e7eb;\n           padding: 6px 8px;\n           cursor: pointer;\n           border-radius: 4px;\n           transition: all 0.2s;\n           white-space: nowrap;\n           overflow: hidden;\n           text-overflow: ellipsis;\n        }\n        .building-item:hover {\n           background: rgba(46, 242, 200, 0.15);\n           color: #2ef2c8;\n           padding-left: 12px;\n        }\n\n        /* Bottom Strip */\n        .bottom-strip {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          gap: 24px;\n        }\n        .analytics-block { flex: 1; display: flex; align-items: center; gap: 32px; }\n        .metric-group { display: flex; flex-direction: column; gap: 4px; }\n        .metric-label { font-size: 9px; color: #9ca3af; }\n        .metric-bars { display: flex; gap: 2px; height: 12px; align-items: flex-end; }\n        :global(.bar) { width: 3px; background: #2ef2c8; opacity: 0.3; height: 100%; transition: opacity 0.2s; }\n        :global(.bar.active) { opacity: 0.8; }\n\n        .status-pill {\n          padding: 4px 12px;\n          background: rgba(239, 68, 68, 0.15);\n          border: 1px solid rgba(239, 68, 68, 0.3);\n          border-radius: 20px;\n          font-size: 10px;\n          color: #fca5a5;\n          display: flex;\n          align-items: center;\n          gap: 6px;\n        }\n        .status-dot { width: 6px; height: 6px; background: #ef4444; border-radius: 50%; animation: blink 1s infinite; }\n\n        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }\n\n        #tooltip {\n          position: absolute;\n          background: rgba(10, 10, 10, 0.95);\n          color: #fff;\n          padding: 8px 16px;\n          border-radius: 6px;\n          font-size: 11px;\n          font-weight: 500;\n          pointer-events: none;\n          display: none;\n          z-index: 2000;\n          border: 1px solid rgba(255, 255, 255, 0.08) ;\n          backdrop-filter: blur(4px);\n        }\n\n        .global-grid {\n          position: fixed;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background-image: \n            radial-gradient(circle, rgba(255,255,255,0.03) 1px, transparent 1px),\n            linear-gradient(rgba(255,255,255,0.01) 1px, transparent 1px),\n            linear-gradient(90deg, rgba(255,255,255,0.01) 1px, transparent 1px);\n          background-size: 40px 40px, 120px 120px, 120px 120px;\n          pointer-events: none;\n          z-index: 500;\n        }\n        /* Inspector Panel (Right Sidebar) */\n        #inspector-panel {\n          position: fixed;\n          top: 32px;\n          right: 32px;\n          bottom: 120px;\n          width: 320px;\n          background: rgba(10, 12, 16, 0.85);\n          backdrop-filter: blur(20px);\n          border: 1px solid rgba(46, 242, 200, 0.2);\n          border-radius: 24px;\n          padding: 28px;\n          pointer-events: auto;\n          display: flex;\n          flex-direction: column;\n          box-shadow: 0 20px 50px rgba(0,0,0,0.5);\n          animation: slideInRight 0.3s cubic-bezier(0.16, 1, 0.3, 1);\n          z-index: 2000;\n        }\n        @keyframes slideInRight {\n          from { transform: translateX(100%); opacity: 0; }\n          to { transform: translateX(0); opacity: 1; }\n        }\n        .modal-close {\n          align-self: flex-end;\n          background: rgba(255,255,255,0.06);\n          border: 1px solid rgba(255,255,255,0.1);\n          border-radius: 50%;\n          width: 28px;\n          height: 28px;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          color: #9ca3af;\n          font-size: 14px;\n          transition: all 0.15s;\n          margin-bottom: -10px;\n        }\n        .modal-close:hover { background: rgba(255,255,255,0.12); color: #fff; }\n        .modal-type-badge {\n          display: inline-block;\n          padding: 2px 10px;\n          background: rgba(46, 242, 200, 0.12);\n          border: 1px solid rgba(46, 242, 200, 0.3);\n          border-radius: 20px;\n          font-size: 10px;\n          font-weight: 700;\n          letter-spacing: 0.1em;\n          text-transform: uppercase;\n          color: #2ef2c8;\n          margin-bottom: 12px;\n        }\n        .modal-name {\n          font-size: 22px;\n          font-weight: 700;\n          color: #e5e7eb;\n          margin-bottom: 4px;\n          letter-spacing: -0.5px;\n        }\n        .modal-version {\n          font-size: 12px;\n          color: #9ca3af;\n          margin-bottom: 16px;\n        }\n        .modal-desc {\n          font-size: 14px;\n          line-height: 1.7;\n          color: #d1d5db;\n          border-top: 1px solid rgba(255,255,255,0.06);\n          padding-top: 16px;\n        }\n        .modal-confidence {\n          margin-top: 16px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n        .modal-conf-bar-bg {\n          flex: 1;\n          height: 4px;\n          background: rgba(255,255,255,0.08);\n          border-radius: 2px;\n          overflow: hidden;\n        }\n        .modal-conf-bar-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #2ef2c8, #86a8ff);\n          border-radius: 2px;\n          transition: width 0.4s ease;\n        }\n        .modal-conf-label {\n          font-size: 10px;\n          color: #9ca3af;\n          min-width: 36px;\n          text-align: right;\n        }\n      `}</style>\n\n            <div className=\"global-grid\"></div>\n            <div ref={containerRef} className=\"absolute inset-0 z-0 h-full w-full\" />\n\n            <div id=\"ui-overlay\">\n                <div className=\"hud-card scope-block\">\n                    <div className=\"scope-item\"><span>REGION</span> <span>PX-992</span></div>\n                    <div className=\"scope-item\"><span>TIME</span> <span id=\"clock\">--:--:--</span></div>\n                    <div className=\"scope-item\">\n                        <span>SEED</span>\n                        <input\n                            type=\"text\"\n                            value={seed}\n                            onChange={(e) => setSeed(e.target.value)}\n                            className=\"bg-transparent border-none text-[#2ef2c8] outline-none text-right w-24 font-bold\"\n                            style={{ pointerEvents: 'auto' }}\n                        />\n                    </div>\n                    <div className=\"scope-item\"><span>STATUS</span> <span className={jobStatus === 'failed' ? 'text-red-500' : 'text-emerald-400'}>{jobStatus.toUpperCase()}</span></div>\n                    <div className=\"scope-item\"><span>SURFACE</span> <span className=\"uppercase\">{repoName || 'SCANNING...'}</span></div>\n                </div>\n\n                <div className=\"hud-card stats-card\">\n                    <div className=\"stats-header\">ANALYSIS PROGRESS</div>\n                    <div className=\"stats-main\">\n                        <div>\n                            <div className=\"stats-number\">{Math.round(jobProgress)}%</div>\n                            <div className=\"stats-sub\">{jobStatus.toUpperCase()}</div>\n                        </div>\n                        <svg className=\"stats-ring\" viewBox=\"0 0 36 36\">\n                            <path d=\"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831\" fill=\"none\" stroke=\"#2ef2c833\" strokeWidth=\"2\" />\n                            <path d=\"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831\" fill=\"none\" stroke=\"#2ef2c8\" strokeWidth=\"2\" strokeDasharray={`${jobProgress}, 100`} />\n                        </svg>\n                    </div>\n                </div>\n\n                {!selectedComponent && componentsByType.length > 0 && (\n                    <div className=\"hud-card building-list-card\">\n                        <div className=\"building-list-header\">ASSET DIRECTORY</div>\n                        <div className=\"building-list-content\">\n                            {componentsByType.map(group => (\n                                <div key={group.type}>\n                                    <div className=\"building-group-title\">{group.type.replace(/_/g, ' ')}</div>\n                                    {group.items.map(item => (\n                                        <div\n                                            key={item.name}\n                                            className=\"building-item\"\n                                            onClick={() => {\n                                                if (triggerFocusRef.current) triggerFocusRef.current(item.name);\n                                            }}\n                                        >\n                                            {item.name}\n                                        </div>\n                                    ))}\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n                )}\n\n                <div className=\"hud-card bottom-strip\">\n                    <div className=\"analytics-block\">\n                        <div className=\"metric-group\">\n                            <div className=\"metric-label\">SYSTEM_LOAD</div>\n                            <div className=\"metric-bars\" id=\"load-bars\"></div>\n                        </div>\n                        <div className=\"metric-group\">\n                            <div className=\"metric-label\">COMPONENTS</div>\n                            <div className=\"stats-sub\">{apiComponents.length} DETECTED</div>\n                        </div>\n                        <div className=\"metric-group\">\n                            <div className=\"metric-label\">THREAT LEVEL</div>\n                            <div style={{ fontSize: '11px', color: '#ef4444' }}>0 NONE</div>\n                        </div>\n                    </div>\n                    <div className=\"status-pill\" style={{ borderColor: jobStatus === 'failed' ? 'rgba(239, 68, 68, 0.3)' : 'rgba(46, 242, 200, 0.3)', color: jobStatus === 'failed' ? '#fca5a5' : '#2ef2c8', background: jobStatus === 'failed' ? 'rgba(239, 68, 68, 0.15)' : 'rgba(46, 242, 200, 0.1)' }}>\n                        <div className=\"status-dot\" style={{ backgroundColor: jobStatus === 'failed' ? '#ef4444' : '#2ef2c8' }}></div>\n                        {jobStatus === 'done' || jobStatus === 'succeeded' ? 'ANALYSIS COMPLETE' : `ANALYZING ${repoName || 'REPOSITORY'}...`}\n                    </div>\n                </div>\n            </div>\n\n            <div id=\"tooltip\"></div>\n\n            {/* Inspector Panel */}\n            {selectedComponent && (\n                <div id=\"inspector-panel\">\n                    <button className=\"modal-close\" onClick={closeModal} aria-label=\"Close\">âœ•</button>\n                    <div className=\"mt-2\">\n                        <div className=\"modal-type-badge\">{selectedComponent.category || selectedComponent.type || 'Component'}</div>\n                        <div className=\"modal-name\">{selectedComponent.name}</div>\n                        {selectedComponent.version && (\n                            <div className=\"modal-version\">v{selectedComponent.version}</div>\n                        )}\n                        <div className=\"modal-desc\">\n                            {selectedComponent.description || <em style={{ color: '#6b7280' }}>No description available.</em>}\n                        </div>\n                        {typeof selectedComponent.confidence === 'number' && (\n                            <div className=\"modal-confidence\">\n                                <span className=\"modal-conf-label\" style={{ fontSize: '9px', color: '#9ca3af', minWidth: 'unset' }}>CONFIDENCE</span>\n                                <div className=\"modal-conf-bar-bg\">\n                                    <div\n                                        className=\"modal-conf-bar-fill\"\n                                        style={{ width: `${Math.round(selectedComponent.confidence * 100)}%` }}\n                                    />\n                                </div>\n                                <span className=\"modal-conf-label\">{Math.round(selectedComponent.confidence * 100)}%</span>\n                            </div>\n                        )}\n                        {selectedComponent.docUrl && (\n                            <div className=\"mt-6\">\n                                <a\n                                    href={selectedComponent.docUrl}\n                                    target=\"_blank\"\n                                    rel=\"noopener noreferrer\"\n                                    className=\"inline-flex items-center gap-2 rounded-lg border border-[#2ef2c8]/30 bg-[#2ef2c8]/10 px-4 py-2 text-xs font-bold text-[#2ef2c8] transition-all hover:bg-[#2ef2c8]/20\"\n                                >\n                                    <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                                        <path d=\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\" />\n                                        <path d=\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\" />\n                                    </svg>\n                                    DOCUMENTATION\n                                </a>\n                            </div>\n                        )}\n                        <div className=\"mt-8 border-t border-white/5 pt-6\">\n                            <h4 className=\"text-[10px] font-bold text-white/30 uppercase tracking-widest mb-4\">Properties</h4>\n                            <div className=\"space-y-3\">\n                                <div className=\"flex justify-between text-[11px]\">\n                                    <span className=\"text-white/40\">Status</span>\n                                    <span className=\"text-emerald-400 font-medium\">Valid</span>\n                                </div>\n                                <div className=\"flex justify-between text-[11px]\">\n                                    <span className=\"text-white/40\">Tier</span>\n                                    <span className=\"text-white/80\">Core Component</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n\nexport default function LabPage() {\n    return (\n        <Suspense fallback={\n            <div className=\"flex h-screen w-full items-center justify-center bg-[#070a0f] text-[#2ef2c8]\">\n                <div className=\"text-sm font-bold tracking-widest\">INITIALIZING INTERFACE...</div>\n            </div>\n        }>\n            <LabContent />\n        </Suspense>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/asaki/Documents/codes/first-commit/apps/web/src/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/asaki/Documents/codes/first-commit/apps/web/src/app/loading/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/asaki/Documents/codes/first-commit/apps/web/src/app/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":3,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":57,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useCallback"},"fix":{"range":[58,71],"text":""},"desc":"Remove unused variable \"useCallback\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2095,2098],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2095,2098],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":103,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4126,4129],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4126,4129],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/unsupported-syntax","severity":1,"message":"Compilation Skipped: The 'eval' function is not supported\n\nEval is an anti-pattern in JavaScript, and the code executed cannot be evaluated by React Compiler.\n\n/home/asaki/Documents/codes/first-commit/apps/web/src/app/page.tsx:138:27\n  136 |       document.head.appendChild(im);\n  137 |\n> 138 |       const THREE = await eval(`import('https://unpkg.com/three@0.161.0/build/three.module.js')`);\n      |                           ^^^^ The 'eval' function is not supported\n  139 |       const { OrbitControls } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/controls/OrbitControls.js')`);\n  140 |       const { RoundedBoxGeometry } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/geometries/RoundedBoxGeometry.js')`);\n  141 |\n\n","line":138,"column":27,"nodeType":null,"endLine":138,"endColumn":31},{"ruleId":"react-hooks/unsupported-syntax","severity":1,"message":"Compilation Skipped: The 'eval' function is not supported\n\nEval is an anti-pattern in JavaScript, and the code executed cannot be evaluated by React Compiler.\n\n/home/asaki/Documents/codes/first-commit/apps/web/src/app/page.tsx:139:39\n  137 |\n  138 |       const THREE = await eval(`import('https://unpkg.com/three@0.161.0/build/three.module.js')`);\n> 139 |       const { OrbitControls } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/controls/OrbitControls.js')`);\n      |                                       ^^^^ The 'eval' function is not supported\n  140 |       const { RoundedBoxGeometry } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/geometries/RoundedBoxGeometry.js')`);\n  141 |\n  142 |       const THEME = {\n\n","line":139,"column":39,"nodeType":null,"endLine":139,"endColumn":43},{"ruleId":"react-hooks/unsupported-syntax","severity":1,"message":"Compilation Skipped: The 'eval' function is not supported\n\nEval is an anti-pattern in JavaScript, and the code executed cannot be evaluated by React Compiler.\n\n/home/asaki/Documents/codes/first-commit/apps/web/src/app/page.tsx:140:44\n  138 |       const THREE = await eval(`import('https://unpkg.com/three@0.161.0/build/three.module.js')`);\n  139 |       const { OrbitControls } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/controls/OrbitControls.js')`);\n> 140 |       const { RoundedBoxGeometry } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/geometries/RoundedBoxGeometry.js')`);\n      |                                            ^^^^ The 'eval' function is not supported\n  141 |\n  142 |       const THEME = {\n  143 |         bg: 0x070a0f, tints: {\n\n","line":140,"column":44,"nodeType":null,"endLine":140,"endColumn":48},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":149,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5753,5756],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5753,5756],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":149,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5766,5769],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5766,5769],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":149,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5781,5784],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5781,5784],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":149,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5796,5799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5796,5799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":151,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5874,5877],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5874,5877],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":368,"column":15,"nodeType":"JSXOpeningElement","endLine":372,"endColumn":17}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport Image from 'next/image';\n\nconst DEMO_ANALYSIS = [\n  // Towers (Languages)\n  { name: 'Next.js', type: 'language', doc_description: 'Core web framework', version: '15.0.0', confidence: 0.98 },\n  { name: 'TypeScript', type: 'language', doc_description: 'Typed JavaScript', version: '5.2.0', confidence: 0.99 },\n  { name: 'React', type: 'language', doc_description: 'UI Library', version: '19.0.0', confidence: 0.97 },\n  // Silos (Databases & Storage)\n  { name: 'PostgreSQL', type: 'database', doc_description: 'Main relational DB', version: '16.0', confidence: 0.95 },\n  { name: 'Redis', type: 'database', doc_description: 'High-speed cache', version: '7.2', confidence: 0.92 },\n  { name: 'S3 Storage', type: 'database', doc_description: 'Blob storage abstraction', version: 'v2', confidence: 0.90 },\n  // PowerPlants (Frameworks & Libraries)\n  { name: 'Tailwind CSS', type: 'framework', doc_description: 'Utility styling', version: '4.0', confidence: 0.96 },\n  { name: 'Prisma', type: 'library', doc_description: 'ORM Layer', version: '5.8', confidence: 0.94 },\n  { name: 'Lucide React', type: 'library', doc_description: 'Icon system', version: '0.400', confidence: 0.93 },\n  // Turbines (Tooling & Animations)\n  { name: 'Framer Motion', type: 'animation', doc_description: 'Smooth transitions', version: '11.0', confidence: 0.91 },\n  { name: 'ESLint', type: 'tooling', doc_description: 'Code linting', version: '9.0', confidence: 0.89 },\n  // Transmission Towers (CI/CD & Infra)\n  { name: 'GitHub Actions', type: 'ci_cd', doc_description: 'Automation CI', version: 'v4', confidence: 0.97 },\n  { name: 'Vercel Edge', type: 'infra', doc_description: 'Deployment surface', version: 'global', confidence: 0.95 },\n];\n\nexport default function Home() {\n  const [repoUrl, setRepoUrl] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  // Demo State\n  const [isDemo, setIsDemo] = useState(false);\n  const [apiComponents, setApiComponents] = useState<any[]>([]);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const validateAndNormalize = (input: string) => {\n    const trimmed = input.trim();\n    if (!trimmed) return null;\n\n    // Pattern matching\n    const githubRegex = /^(?:https?:\\/\\/)?(?:www\\.)?github\\.com\\/([^/]+)\\/([^/]+(?:\\.git)?)$/;\n    const shortRegex = /^([^/]+)\\/([^/]+(?:\\.git)?)$/;\n\n    let match = trimmed.match(githubRegex);\n    if (!match) {\n      match = trimmed.match(shortRegex);\n    }\n\n    if (match) {\n      const owner = match[1];\n      const repo = match[2].replace(/\\.git$/, '');\n      return `https://github.com/${owner}/${repo}`;\n    }\n    return null;\n  };\n\n  const parseOwnerRepo = (normalizedUrl: string) => {\n    const m = normalizedUrl.match(/^https:\\/\\/github\\.com\\/([^/]+)\\/([^/]+)$/);\n    if (!m) return null;\n    return { owner: m[1], name: m[2] };\n  };\n\n  const handleAnalyze = async () => {\n    const normalized = validateAndNormalize(repoUrl);\n    if (!normalized) {\n      setError('Please enter a valid GitHub repository URL (e.g., owner/repo)');\n      return;\n    }\n\n    const parsed = parseOwnerRepo(normalized);\n    if (!parsed) {\n      setError('Could not parse owner/repo from URL');\n      return;\n    }\n\n    setError('');\n    setLoading(true);\n\n    try {\n      const apiBase = process.env.NEXT_PUBLIC_API_BASE || 'http://localhost:3001';\n\n      const res = await fetch(`${apiBase}/api/repos`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          url: normalized,\n          owner: parsed.owner,\n          name: parsed.name,\n          default_branch: 'main',\n        }),\n      });\n\n      if (!res.ok) {\n        const txt = await res.text();\n        throw new Error(txt || `Request failed: ${res.status}`);\n      }\n\n      const data: { repoId: number; jobId: number } = await res.json();\n      window.location.href = `/lab?repoId=${encodeURIComponent(String(data.repoId))}&jobId=${encodeURIComponent(\n        String(data.jobId)\n      )}`;\n    } catch (e: any) {\n      setError(e?.message ? `API error: ${e.message}` : 'API error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDemo = () => {\n    setError('');\n    setIsDemo(true);\n    setApiComponents(DEMO_ANALYSIS);\n  };\n\n  const scrollToSection = (e: React.MouseEvent<HTMLAnchorElement | HTMLButtonElement>, id: string) => {\n    e.preventDefault();\n    const element = document.getElementById(id);\n    if (element) {\n      element.scrollIntoView({ behavior: 'smooth' });\n    }\n  };\n\n  // --- MINIMAL 3D RENDERER PORT FROM LAB ---\n  useEffect(() => {\n    if (typeof window === 'undefined' || !isDemo || !containerRef.current) return;\n\n    let cleanup = () => { };\n\n    const loadGraphics = async () => {\n      const im = document.createElement('script');\n      im.type = 'importmap';\n      im.textContent = JSON.stringify({\n        imports: { \"three\": \"https://unpkg.com/three@0.161.0/build/three.module.js\" }\n      });\n      document.head.appendChild(im);\n\n      const THREE = await eval(`import('https://unpkg.com/three@0.161.0/build/three.module.js')`);\n      const { OrbitControls } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/controls/OrbitControls.js')`);\n      const { RoundedBoxGeometry } = await eval(`import('https://unpkg.com/three@0.161.0/examples/jsm/geometries/RoundedBoxGeometry.js')`);\n\n      const THEME = {\n        bg: 0x070a0f, tints: {\n          language: 0xe5e7eb, database: 0x86a8ff, framework: 0x2ef2c8,\n          library: 0xd1d5db, infra: 0xa855f7, ci_cd: 0x3b82f6, animation: 0xfcd34d, tooling: 0xfacc15, default: 0xd9dde3\n        }\n      };\n\n      let scene: any, camera: any, renderer: any, controls: any;\n      const buildingsGroup = new THREE.Group();\n      const animatables: any[] = [];\n\n      const init = () => {\n        scene = new THREE.Scene();\n        camera = new THREE.PerspectiveCamera(35, containerRef.current!.clientWidth / containerRef.current!.clientHeight, 1, 5000);\n        camera.position.set(400, 300, 400);\n\n        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n        renderer.setSize(containerRef.current!.clientWidth, containerRef.current!.clientHeight);\n        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\n        containerRef.current!.appendChild(renderer.domElement);\n\n        controls = new OrbitControls(camera, renderer.domElement);\n        controls.enableDamping = true;\n        controls.autoRotate = true;\n        controls.autoRotateSpeed = 0.5;\n\n        scene.add(new THREE.AmbientLight(0xffffff, 0.4));\n        const dirLight = new THREE.DirectionalLight(0xffffff, 1);\n        dirLight.position.set(100, 200, 100);\n        scene.add(dirLight);\n        scene.add(buildingsGroup);\n\n        // Grid\n        const grid = new THREE.GridHelper(1000, 50, 0x2ef2c8, 0x1a1a1a);\n        grid.position.y = -1;\n        scene.add(grid);\n\n        // Generate City\n        const gridSpacing = 80;\n        apiComponents.forEach((item, i) => {\n          const color = THEME.tints[item.type] || THEME.tints.default;\n          const mat = new THREE.MeshStandardMaterial({ color });\n          let mesh;\n\n          if (item.type === 'language') {\n            const h = 40 + Math.random() * 40;\n            mesh = new THREE.Mesh(new RoundedBoxGeometry(15, h, 15, 2, 2).translate(0, h / 2, 0), mat);\n          } else if (item.type === 'database') {\n            mesh = new THREE.Mesh(new THREE.CylinderGeometry(12, 12, 35, 16).translate(0, 17.5, 0), mat);\n          } else if (item.type === 'ci_cd' || item.type === 'infra') {\n            mesh = new THREE.Mesh(new THREE.BoxGeometry(4, 70, 4).translate(0, 35, 0), mat);\n          } else {\n            mesh = new THREE.Mesh(new THREE.BoxGeometry(20, 20, 20).translate(0, 10, 0), mat);\n          }\n\n          const ox = (i % 5) * gridSpacing - gridSpacing * 2;\n          const oz = Math.floor(i / 5) * gridSpacing - gridSpacing;\n          mesh.position.set(ox, 0, oz);\n          buildingsGroup.add(mesh);\n        });\n      };\n\n      const animate = () => {\n        const frameId = requestAnimationFrame(animate);\n        controls.update();\n        animatables.forEach(f => f());\n        renderer.render(scene, camera);\n        cleanup = () => {\n          cancelAnimationFrame(frameId);\n          if (containerRef.current) containerRef.current.innerHTML = '';\n          renderer.dispose();\n        };\n      };\n\n      init();\n      animate();\n    };\n\n    loadGraphics();\n    return () => cleanup();\n  }, [isDemo, apiComponents]);\n\n  return (\n    <main className=\"relative min-h-screen w-full overflow-hidden bg-black text-white selection:bg-white selection:text-black\">\n      {/* Font Injection for Prototype */}\n      <link\n        href=\"https://api.fontshare.com/v2/css?f[]=general-sans@500,600,400&display=swap\"\n        rel=\"stylesheet\"\n      />\n\n      <style jsx global>{`\n        body {\n          font-family: 'General Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n          background: #000;\n        }\n        .text-gradient {\n          background: linear-gradient(144.5deg, rgba(255,255,255,1) 40%, rgba(255,255,255,0.6) 115%);\n          -webkit-background-clip: text;\n          -webkit-text-fill-color: transparent;\n        }\n        .grid-overlay {\n          background-image: radial-gradient(circle, rgba(255,255,255,0.05) 1px, transparent 1px);\n          background-size: 32px 32px;\n        }\n      `}</style>\n\n\n      {/* Navbar */}\n      <nav className=\"absolute top-0 left-0 right-0 z-50 flex w-full items-center justify-between px-6 py-5 lg:px-[120px] lg:py-[20px]\">\n        <div className=\"flex items-center gap-[30px]\">\n          <Image src=\"/repoly.svg\" alt=\"REPOLY\" width={100} height={100} priority />\n          <div className=\"hidden items-center gap-[30px] lg:flex\">\n            {[\n              { label: 'Product', id: 'product' },\n              { label: 'How it Works', id: 'how' },\n              { label: '3D Demo', id: 'demo' },\n            ].map((item) => (\n              <a\n                key={item.label}\n                href={`#${item.id}`}\n                onClick={(e) => scrollToSection(e, item.id)}\n                className=\"group flex items-center gap-2 text-[14px] font-medium text-white/90 transition-colors hover:text-white\"\n              >\n                {item.label}\n              </a>\n            ))}\n          </div>\n        </div>\n      </nav>\n\n      {/* Hero Content */}\n      <section className=\"relative z-30 flex min-h-[90vh] flex-col items-center justify-center px-6 text-center pt-[140px] pb-[100px]\">\n        {/* Background Video (Restricted to Hero) */}\n        <div className=\"absolute inset-x-0 top-0 bottom-[10%] z-0 overflow-hidden rounded-b-[60px]\">\n          <video\n            autoPlay\n            muted\n            loop\n            playsInline\n            className=\"h-full w-full object-cover opacity-60\"\n          >\n            <source\n              src=\"https://d8j0ntlcm91z4.cloudfront.net/user_38xzZboKViGWJOttwIXH07lWA1P/hf_20260217_030345_246c0224-10a4-422c-b324-070b7c0eceda.mp4\"\n              type=\"video/mp4\"\n            />\n          </video>\n          <div className=\"absolute inset-0 bg-gradient-to-b from-black/10 via-black/20 to-black/60 z-10\" />\n          <div className=\"grid-overlay absolute inset-0 z-20 pointer-events-none opacity-20\" />\n        </div>\n\n        <div className=\"relative z-30 flex flex-col items-center\">\n          {/* Badge */}\n          <div className=\"mb-10 flex items-center gap-2 rounded-full border border-white/20 bg-white/10 px-4 py-1.5 backdrop-blur-sm\">\n            <div className=\"h-1 w-1 rounded-full bg-white shadow-[0_0_8px_white]\" />\n            <span className=\"text-[13px] font-medium\">\n              <span className=\"text-white/60\">Hackathon Prototype</span>\n              <span className=\"ml-1 text-white\">Live Demo Soon</span>\n            </span>\n          </div>\n\n          <h1 className=\"text-gradient max-w-[613px] text-[36px] font-medium leading-[1.1] tracking-tight lg:text-[56px] lg:leading-[1.28]\">\n            Understand Any Repository as a Living System\n          </h1>\n\n          <p className=\"mt-6 max-w-[680px] text-[15px] font-normal leading-relaxed text-white/90\">\n            Repoly analyzes repositories and visualizes them as an interactive 3D schematic â€” languages become towers,\n            databases become silos, CI/CD becomes transmission lines. The mapping engine is open and extensible.\n          </p>\n\n          <div className=\"mt-12 w-full max-w-[720px]\">\n            <div className={`group flex h-14 w-full items-center gap-3 rounded-full border bg-white/5 p-1 pl-5 backdrop-blur transition-all duration-300 ${error ? 'border-red-400/30' : 'border-white/10 focus-within:border-white/25 focus-within:ring-1 focus-within:ring-white/15'}`}>\n              <svg className=\"h-5 w-5 opacity-70\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                <path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.041-1.416-4.041-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\" />\n              </svg>\n              <input\n                type=\"text\"\n                value={repoUrl}\n                onChange={(e) => { setRepoUrl(e.target.value); setError(''); }}\n                onKeyDown={(e) => e.key === 'Enter' && handleAnalyze()}\n                placeholder=\"https://github.com/owner/repo\"\n                className=\"w-full bg-transparent text-[15px] font-normal text-white outline-none placeholder:text-white/40\"\n              />\n              <div className=\"flex gap-2 mr-1\">\n                <button\n                  onClick={handleAnalyze}\n                  disabled={loading}\n                  className=\"h-12 rounded-full bg-white px-8 text-sm font-semibold text-black transition-all hover:opacity-90 active:scale-95 disabled:opacity-60 disabled:cursor-not-allowed\"\n                >\n                  {loading ? 'Analyzingâ€¦' : 'Analyze'}\n                </button>\n                <button\n                  onClick={handleDemo}\n                  className=\"h-12 rounded-full border border-white/20 bg-white/10 px-8 text-sm font-semibold text-white backdrop-blur transition-all hover:bg-white/20 active:scale-95\"\n                >\n                  Demo\n                </button>\n              </div>\n            </div>\n            {error && <p className=\"mt-3 text-left text-xs font-medium text-red-300/80 pl-5\">{error}</p>}\n          </div>\n        </div>\n      </section>\n\n      {/* Feature Sections */}\n      <div className=\"relative z-30 bg-black/40 border-t border-white/5\">\n        {/* Product Section */}\n        <section id=\"product\" className=\"max-w-7xl mx-auto py-24 px-6\">\n          <div className=\"grid lg:grid-cols-2 gap-16 items-center\">\n            <div className=\"text-left\">\n              <h2 className=\"text-3xl font-medium mb-6 text-gradient lg:text-4xl\">Architecture Visualization</h2>\n              <p className=\"text-[16px] text-white/60 leading-relaxed mb-8\">\n                Stop manually drawing diagrams. Repoly automatically extracts the mental model of your codebase and renders it as a navigable 3D world.\n              </p>\n              <div className=\"grid grid-cols-2 gap-4\">\n                {[\n                  { title: \"Auto-Discovery\", desc: \"Instant repo scanning\" },\n                  { title: \"Real-time\", desc: \"Live analysis updates\" }\n                ].map((f) => (\n                  <div key={f.title} className=\"p-4 rounded-2xl border border-white/5 bg-white/5\">\n                    <div className=\"text-white font-medium text-sm mb-1\">{f.title}</div>\n                    <div className=\"text-white/40 text-xs\">{f.desc}</div>\n                  </div>\n                ))}\n              </div>\n            </div>\n            <div className=\"aspect-video rounded-3xl bg-white/5 border border-white/10 overflow-hidden relative group\">\n              <img\n                src=\"/preview.png\"\n                alt=\"Architecture Visualization Preview\"\n                className=\"w-full h-full object-cover opacity-80 group-hover:scale-105 transition-transform duration-500\"\n              />\n              <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-60\" />\n            </div>\n          </div>\n        </section>\n\n        {/* How it Works Section */}\n        <section id=\"how\" className=\"max-w-4xl mx-auto py-24 px-6 border-t border-white/5\">\n          <div className=\"text-center\">\n            <h2 className=\"text-3xl font-medium mb-6 text-gradient lg:text-4xl\">Automated Ingestion</h2>\n            <p className=\"text-[16px] text-white/60 leading-relaxed mb-10 max-w-2xl mx-auto\">\n              Our specialized analysis engine clones your repository, detects components using advanced pattern matching,\n              and maps them to a consistent 3D visual language.\n            </p>\n            <div className=\"flex flex-wrap justify-center gap-6\">\n              {[\"Language Detection\", \"Dependency Mapping\", \"Service Discovery\"].map((item) => (\n                <div key={item} className=\"flex items-center gap-3 text-sm text-white/70 px-4 py-2 rounded-full border border-white/5 bg-white/5\">\n                  <div className=\"h-1.5 w-1.5 rounded-full bg-emerald-400\" />\n                  {item}\n                </div>\n              ))}\n            </div>\n          </div>\n        </section>\n\n        {/* 3D Demo Section */}\n        <section id=\"demo\" className=\"max-w-7xl mx-auto py-32 px-6 border-t border-white/5\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-3xl font-medium mb-6 text-gradient lg:text-5xl\">Live 3D Schematic</h2>\n            <p className=\"max-w-2xl mx-auto text-[16px] text-white/60 leading-relaxed\">\n              {isDemo ? \"Viewing the guaranteed system demo. No API connection required.\" : \"Interact with your city. Zoom into individual modules, trace dependency lines, and understand the pulse of your development lifecycle.\"}\n            </p>\n          </div>\n\n          <div className=\"relative aspect-video w-full rounded-3xl bg-white/5 border border-white/10 overflow-hidden\">\n            {!isDemo ? (\n              <div className=\"grid h-full md:grid-cols-3 gap-6 p-12\">\n                {[\n                  { label: 'Towers', desc: 'Languages & Services' },\n                  { label: 'Silos', desc: 'Databases & Caches' },\n                  { label: 'Blocks', desc: 'CI/CD & Build Steps' },\n                ].map((item) => (\n                  <div key={item.label} className=\"p-8 rounded-3xl border border-white/5 bg-white/5 text-left hover:bg-white/10 transition-all flex flex-col justify-center\">\n                    <div className=\"text-xl font-medium text-white mb-2\">{item.label}</div>\n                    <div className=\"text-sm text-white/40\">{item.desc}</div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div ref={containerRef} className=\"absolute inset-0 h-full w-full\" />\n            )}\n            {!isDemo && (\n              <div className=\"absolute inset-x-0 bottom-12 flex justify-center\">\n                <button\n                  onClick={handleDemo}\n                  className=\"rounded-full bg-white px-8 py-3 text-sm font-semibold text-black hover:opacity-90 transition-all\"\n                >\n                  Launch 3D Explorer\n                </button>\n              </div>\n            )}\n          </div>\n        </section>\n      </div>\n    </main>\n  );\n}\n","usedDeprecatedRules":[]}]
